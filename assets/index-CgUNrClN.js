var A=Object.defineProperty;var b=(i,s,r)=>s in i?A(i,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):i[s]=r;var o=(i,s,r)=>b(i,typeof s!="symbol"?s+"":s,r);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))l(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const p of h.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function r(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function l(a){if(a.ep)return;a.ep=!0;const h=r(a);fetch(a.href,h)}})();class w{constructor({position:s,imageSrc:r,scale:l=1,framesMax:a=1,offset:h}){o(this,"position");o(this,"scale");o(this,"framesMax");o(this,"framesCurrent",0);o(this,"framesElapsed",0);o(this,"framesHold",5);o(this,"image");o(this,"offset");this.position=s,this.scale=l,this.framesMax=a,this.image=new Image,this.image.src="/fighting-game/"+r,this.offset=h}animateFrames(){this.framesElapsed++,this.framesElapsed%this.framesHold===0&&(this.framesCurrent<this.framesMax-1?this.framesCurrent++:this.framesCurrent=0)}draw(){f.drawImage(this.image,this.framesCurrent*(this.image.width/this.framesMax),0,this.image.width/this.framesMax,this.image.height,this.position.x+this.offset.x,this.position.y+this.offset.y,this.image.width/this.framesMax*this.scale,this.image.height*this.scale)}update(){this.draw(),this.animateFrames()}}class k extends w{constructor({position:r,velocity:l,offset:a,imageSrc:h,scale:p=1,framesMax:M=1,sprites:R,attackRow:d}){super({imageSrc:h,scale:p,framesMax:M,position:r,offset:a});o(this,"velocity");o(this,"height",150);o(this,"width",50);o(this,"lastKeyPressed","");o(this,"isAttacking",!1);o(this,"attackRow");o(this,"health",100);o(this,"dead",!1);o(this,"sprites");if(this.velocity=l,this.attackRow={position:{x:this.position.x,y:this.position.y},offset:d.offset,width:d.width,height:d.height},this.framesCurrent=0,this.framesElapsed=0,this.framesHold=5,this.sprites=R,this.sprites)for(const g in this.sprites)this.sprites[g].image=new Image,this.sprites[g].image.src="/fighting-game/"+this.sprites[g].imageSrc}update(){this.draw(),this.dead||this.animateFrames(),this.attackRow.position.x=this.position.x+this.attackRow.offset.x,this.attackRow.position.y=this.position.y+this.attackRow.offset.y,this.position.x+=this.velocity.x,this.position.y+this.velocity.y>0&&(this.position.y+=this.velocity.y),this.position.y+this.height+this.velocity.y>=n.height-96?(this.velocity.y=0,this.position.y=330):this.velocity.y+=I,this.position.x+this.width+this.velocity.x>=n.width&&(this.velocity.x=0)}attack(){this.switchSprite("attack"),this.isAttacking=!0}takeHit(){this.health-=20,this.health<=0?this.switchSprite("death"):this.switchSprite("takeHit")}switchSprite(r){if(this.sprites){if(this.image===this.sprites.death.image){this.framesCurrent===this.sprites.death.framesMax-1&&(this.dead=!0);return}if(!(this.image===this.sprites.attack.image&&this.framesCurrent<this.sprites.attack.framesMax-1)&&!(this.image===this.sprites.takeHit.image&&this.framesCurrent<this.sprites.takeHit.framesMax-1))switch(r){case"idle":this.image!==this.sprites.idle.image&&(this.image=this.sprites.idle.image,this.framesMax=this.sprites.idle.framesMax,this.framesCurrent=0);break;case"run":this.image!==this.sprites.run.image&&(this.image=this.sprites.run.image,this.framesMax=this.sprites.run.framesMax,this.framesCurrent=0);break;case"jump":this.image!==this.sprites.jump.image&&(this.image=this.sprites.jump.image,this.framesMax=this.sprites.jump.framesMax,this.framesCurrent=0);break;case"fall":this.image!==this.sprites.fall.image&&(this.image=this.sprites.fall.image,this.framesMax=this.sprites.fall.framesMax,this.framesCurrent=0);break;case"attack":this.image!==this.sprites.attack.image&&(this.image=this.sprites.attack.image,this.framesMax=this.sprites.attack.framesMax,this.framesCurrent=0);break;case"takeHit":this.image!==this.sprites.takeHit.image&&(this.image=this.sprites.takeHit.image,this.framesMax=this.sprites.takeHit.framesMax,this.framesCurrent=0);break;case"death":this.image!==this.sprites.death.image&&(this.image=this.sprites.death.image,this.framesMax=this.sprites.death.framesMax,this.framesCurrent=0);break}}}}const n=document.querySelector("canvas"),C=document.querySelector("#player-health"),H=document.querySelector("#enemy-health"),L=document.querySelector(".popup"),y=document.querySelector("#display-text"),P=document.querySelector("#replay-btn"),j=document.querySelector(".timer"),f=n.getContext("2d"),I=1;n.width=1024;n.height=576;const q=new w({position:{x:0,y:0},imageSrc:"/background.png",offset:{x:0,y:0}}),K=new w({position:{x:630,y:128},imageSrc:"/shop.png",scale:2.75,framesMax:6,offset:{x:0,y:0}}),t=new k({position:{x:40,y:0},velocity:{x:0,y:0},offset:{x:-130,y:-153},imageSrc:"/Rigrider/Idle.png",framesMax:10,scale:3,attackRow:{offset:{x:100,y:50},height:40,width:160},sprites:{attack:{imageSrc:"/Rigrider/Attack1.png",framesMax:7},death:{imageSrc:"/Rigrider/Death.png",framesMax:7},fall:{imageSrc:"/Rigrider/Fall.png",framesMax:3},idle:{imageSrc:"/Rigrider/Idle.png",framesMax:10},jump:{imageSrc:"/Rigrider/Jump.png",framesMax:3},run:{imageSrc:"/Rigrider/Run.png",framesMax:8},takeHit:{imageSrc:"/Rigrider/Take hit.png",framesMax:3}}}),e=new k({position:{x:n.width-60,y:0},velocity:{x:0,y:0},offset:{x:-400,y:-183},imageSrc:"/kenji/Idle.png",framesMax:4,scale:2.6,attackRow:{offset:{x:-350,y:50},height:40,width:190},sprites:{attack:{imageSrc:"/kenji/Attack1.png",framesMax:4},death:{imageSrc:"/kenji/Death.png",framesMax:7},fall:{imageSrc:"/kenji/Fall.png",framesMax:2},idle:{imageSrc:"/kenji/Idle.png",framesMax:4},jump:{imageSrc:"/kenji/Jump.png",framesMax:2},run:{imageSrc:"/kenji/Run.png",framesMax:8},takeHit:{imageSrc:"/kenji/Take hit.png",framesMax:3}}}),c={a:{pressed:!1},d:{pressed:!1},ArrowLeft:{pressed:!1},ArrowRight:{pressed:!1}};let m=100;const S=()=>{var i,s;window.requestAnimationFrame(S),f.fillStyle="black",f.fillRect(0,0,n.width,n.height),q.draw(),K.update(),f.fillStyle="rgba(255, 255, 255, 0.15)",f.fillRect(0,0,n.width,n.height),t.update(),e.update(),t.velocity.x=0,e.velocity.x=0,c.a.pressed&&t.lastKeyPressed==="a"?(t.velocity.x=-10,t.switchSprite("run"),t.position.x+t.velocity.x===0&&(t.velocity.x=0)):c.d.pressed&&t.lastKeyPressed==="d"?(t.velocity.x=10,t.switchSprite("run"),t.position.x+t.width+t.velocity.x>=n.width&&(t.velocity.x=0)):t.switchSprite("idle"),t.velocity.y<0?t.switchSprite("jump"):t.velocity.y>0&&t.switchSprite("fall"),c.ArrowLeft.pressed&&e.lastKeyPressed==="ArrowLeft"?(e.velocity.x=-10,e.switchSprite("run"),e.position.x+e.velocity.x===0&&(e.velocity.x=0)):c.ArrowRight.pressed&&e.lastKeyPressed==="ArrowRight"?(e.image=(i=e.sprites)==null?void 0:i.run.image,e.framesMax=(s=e.sprites)==null?void 0:s.run.framesMax,e.velocity.x=10,e.switchSprite("run"),e.position.x+e.width+e.velocity.x>=n.width&&(e.velocity.x=0)):e.switchSprite("idle"),e.velocity.y<0?e.switchSprite("jump"):e.velocity.y>0&&e.switchSprite("fall"),e.position.y+e.height>=t.attackRow.position.y&&e.position.y<=t.attackRow.position.y+t.attackRow.height&&e.position.x+e.width>=t.attackRow.position.x&&e.position.x+t.offset.x<=t.attackRow.position.x+t.attackRow.width&&t.isAttacking&&t.framesCurrent===4&&(e.takeHit(),t.isAttacking=!1,H.style.width=`${e.health}%`),t.isAttacking&&t.framesCurrent===4&&(t.isAttacking=!1),t.position.y+t.height>=e.attackRow.position.y&&t.position.y<=e.attackRow.position.y+e.attackRow.height&&t.position.x+t.width+50>=e.attackRow.position.x&&t.position.x<=e.attackRow.position.x+e.attackRow.width&&e.isAttacking&&e.framesCurrent===2&&(t.takeHit(),e.isAttacking=!1,C.style.width=`${t.health}%`),e.isAttacking&&e.framesCurrent===2&&(e.isAttacking=!1),(t.health<=0||e.health<=0)&&v({player1:t,player2:e,timerId:u})},v=({player1:i,player2:s,timerId:r})=>{r&&clearInterval(r),L.style.display="block",i.health===s.health?(y.textContent="Tie",e.switchSprite("death"),t.switchSprite("death")):i.health>s.health?(y.textContent="Player 1 wins",e.switchSprite("death")):(y.textContent="Player 2 wins",t.switchSprite("death"))};let u;const x=()=>{u=setInterval(()=>{m>0&&(m--,j.innerText=m.toString()),m===0&&v({player1:t,player2:e,timerId:u})},1e3)},E=()=>{const i="playerControlsShown",s=document.querySelector("#ok-button"),r=document.querySelector(".display-player-controls");localStorage.getItem(i)?x():(r.style.display="block",s.addEventListener("click",()=>{localStorage.setItem(i,"true"),r.style.display="none",x()}))};P.addEventListener("click",()=>{location.reload()});window.addEventListener("keydown",i=>{if(!t.dead)switch(i.key){case"d":c.d.pressed=!0,t.lastKeyPressed="d";break;case"a":c.a.pressed=!0,t.lastKeyPressed="a";break;case"w":t.velocity.y=-19;break;case"s":t.attack();break}if(!e.dead)switch(i.key){case"ArrowLeft":c.ArrowLeft.pressed=!0,e.lastKeyPressed="ArrowLeft";break;case"ArrowRight":c.ArrowRight.pressed=!0,e.lastKeyPressed="ArrowRight";break;case"ArrowUp":e.velocity.y=-19;break;case"ArrowDown":e.attack();break}});window.addEventListener("keyup",i=>{switch(i.key){case"d":c.d.pressed=!1;break;case"a":c.a.pressed=!1;break;case"ArrowLeft":c.ArrowLeft.pressed=!1;break;case"ArrowRight":c.ArrowRight.pressed=!1;break}});f.fillRect(0,0,n.width,n.height);S();E();
